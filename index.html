<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" href="/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="Ilze Erba-Brenholma - Textile Artist Portfolio" />
    <title>Ilzebrenn</title>
    <!-- Minimal redirect handling for SPA on GitHub Pages -->
    <script type="text/javascript">
      ;(function () {
        const location = window.location

        // Only clean up infinite redirect loops, not normal GitHub Pages redirects
        if (
          location.search &&
          location.search.includes('~and~') &&
          location.search.split('~and~').length > 3
        ) {
          // Extract the path if possible
          const pathMatch = location.search.match(/\?\/(.*?)($|&|~and~)/)
          if (pathMatch && pathMatch[1]) {
            let cleanPath = '/' + pathMatch[1].split('&')[0].split('~and~')[0]

            // Clean up any percent encoding or unwanted characters
            try {
              cleanPath = decodeURIComponent(cleanPath)
            } catch (e) {
              // If decoding fails, use the raw path
              console.error('Failed to decode URL', e)
            }

            // Remove any remaining % characters
            cleanPath = cleanPath.replace(/%/g, '')

            window.history.replaceState(null, null, cleanPath)
          } else {
            // Last resort - go to home
            window.history.replaceState(null, null, '/')
          }
        }

        // Handle direct % characters in the pathname - a common GitHub Pages issue
        if (location.pathname.includes('%')) {
          let cleanPath = location.pathname

          // Clean up any percent encoding or unwanted characters
          try {
            cleanPath = decodeURIComponent(cleanPath)
          } catch (e) {
            // If decoding fails, use the raw path
            console.error('Failed to decode URL', e)
          }

          // Remove any remaining % characters
          cleanPath = cleanPath.replace(/%/g, '')

          window.history.replaceState(null, null, cleanPath)
        }

        // DO NOT clean up normal /?/ redirects here - let the Vue router handle them
      })()
    </script>
  </head>
  <body>
    <div id="app"></div>
    <script type="module" src="/src/main.js"></script>
  </body>
</html>
