<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" href="/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="Ilze Erba-Brenholma - Textile Artist Portfolio" />
    <title>Ilzebrenn</title>
    <!-- Improved redirect handling for SPA on GitHub Pages -->
    <script type="text/javascript">
      ;(function () {
        // Check if we have a redirect from the 404 page
        if (window.location.search && window.location.search.includes('redirect=true')) {
          // Get the stored path from sessionStorage
          const redirectPath = sessionStorage.getItem('redirectPath') || '/'

          // Remove the redirect flag from sessionStorage to prevent loops
          sessionStorage.removeItem('redirectPath')

          // Replace current URL with the clean path
          window.history.replaceState(null, null, redirectPath)
          return
        }

        // Handle legacy GitHub Pages redirects (for backwards compatibility)
        if (window.location.search && window.location.search.startsWith('?/')) {
          // Extract the path if possible
          const pathMatch = window.location.search.match(/\?\/(.*?)($|&|~and~)/)
          if (pathMatch && pathMatch[1]) {
            let cleanPath = '/' + pathMatch[1].split('&')[0].split('~and~')[0]

            // Clean up any percent encoding or unwanted characters
            try {
              cleanPath = decodeURIComponent(cleanPath)
            } catch (e) {
              // If decoding fails, use the raw path
              console.error('Failed to decode URL', e)
            }

            // Remove any remaining % characters
            cleanPath = cleanPath.replace(/%/g, '')

            window.history.replaceState(null, null, cleanPath)
          }
        }

        // Handle direct % characters in the pathname
        if (window.location.pathname.includes('%')) {
          let cleanPath = window.location.pathname

          // Clean up any percent encoding or unwanted characters
          try {
            cleanPath = decodeURIComponent(cleanPath)
          } catch (e) {
            // If decoding fails, use the raw path
            console.error('Failed to decode URL', e)
          }

          // Remove any remaining % characters
          cleanPath = cleanPath.replace(/%/g, '')

          window.history.replaceState(null, null, cleanPath)
        }
      })()
    </script>
  </head>
  <body>
    <div id="app"></div>
    <script type="module" src="/src/main.js"></script>
  </body>
</html>
